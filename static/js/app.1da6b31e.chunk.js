(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{234:function(e,t){Date.prototype.format=function(){var e=this.getMonth()+1,t=this.getDate();return[(t>9?"":"0")+t,(e>9?"":"0")+e,this.getFullYear()].join("-")},String.prototype.toDate=function(){var e=this.split("-");return new Date(e[2],e[1]-1,e[0])}},378:function(e,t,n){"use strict";n(236);var a,r,o,c,s,l=n(332),i=n(603),u=n(0),f=n.n(u),m=n(17),d=n.n(m),p=n(30),h=n(606),g=n(28),y=n.n(g),b=n(3),v=n.n(b),E=n(602),k=n(604),S=n(211),w=n(113),x=n(55),O=n(5),T=n(4),j=n(2),D=n.n(j),C=n(9),P=n.n(C),L=n(19),I=n.n(L),z=n(11),M=n.n(z),B=n(84),N=n.n(B),W=n(373),A=n.n(W),q=n(35),R=n(24),U=(n(579),n(592),n(593),null),_=((U=R.a.apps.length?R.a.app():R.a.initializeApp({apiKey:"AIzaSyCZ1W91h5gI4Ys3K44apJMX-dfAzKmKOzc",authDomain:"todo-app-594e8.firebaseapp.com",projectId:"todo-app-594e8",storageBucket:"todo-app-594e8.appspot.com",messagingSenderId:"254618059037",appId:"1:254618059037:web:2a162824c6e6dfd3d921f4",measurementId:"G-84M73W8WLD"})).auth(),U.firestore()),F=U.storage(),H=n(200),K=n.n(H),Y=(n(314),a=function(){function e(t,n,a,o,c,s,l){var i=this,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],f=arguments.length>8&&void 0!==arguments[8]&&arguments[8],m=arguments.length>9&&void 0!==arguments[9]&&arguments[9];P()(this,e),K()(this,"toggleSelect",r,this),this.toggleComplete=function(){i.isCompleted=!i.isCompleted},this.taskStore=t,this.id=n,this.task=a,this.cat=o,this.time=c,this.freqPerWeek=s,this.weekCount=l,this.isSelected=f,this.isCompleted=m,this.attachments=u,Object(q.f)(this)}return M()(e,null,[{key:"fromTask",value:function(t,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return new e(t,n.id,n.task,n.cat,n.time,n.freqPerWeek,a,r,o,c)}}]),e}(),r=N()(a.prototype,"toggleSelect",[q.b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.isSelected=!e.isSelected}}}),a),J=(n(234),o=function(){function e(){var t=this;P()(this,e),this.taskList=[],this.loading=!1,this.loadTaskList=function(e,n){var a,r,o,c,s,l,i,u,f,m;return v.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return t.loading=!0,d.next=3,v.a.awrap(_.collection("todolist").doc("default").get());case 3:return r=d.sent,o=Object(E.a)(n,n.getDay()>0?1-n.getDay():-6),c=Object(E.a)(n,n.getDay()>0?7-n.getDay():0),d.next=8,v.a.awrap(t.loadSelectedDate([e],o,c));case 8:if(s=d.sent,l=null==(a=s.find((function(e){return new Date(1e3*e.date.seconds).toLocaleDateString()==n.toLocaleDateString()})))?void 0:a.selectedTasks){d.next=16;break}return u=e+"_"+Object(k.a)(n,"dd-MM-yyyy"),d.next=14,v.a.awrap(_.collection("selectlist").doc(u).get());case 14:f=d.sent,l=null==(i=f.data())?void 0:i.selectedTasks;case 16:r.exists&&r.data().workList?(m=r.data().workList.map((function(e){var n,a=null==(n=l)?void 0:n.find((function(t){return e.id==t.taskId})),r=s.reduce((function(t,n){return n.selectedTasks.find((function(t){return t.taskId==e.id}))?t+1:t}),0);return Y.fromTask(t,e,r,null==a?void 0:a.attachments,null!=a,null==a?void 0:a.isCompleted)})),Object(q.i)((function(){var e;t.taskList=[],(e=t.taskList).push.apply(e,I()(m)),t.loading=!1}))):console.log("No doc values found");case 17:case"end":return d.stop()}}),null,null,null,Promise)},this.loadSelectedDate=function(e,t,n){var a;return v.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a=[],r.next=3,v.a.awrap(_.collection("selectlist").where("user","in",e).where("date",">=",t).where("date","<=",n).get());case 3:return r.sent.forEach((function(e){a.push(e.data())})),r.abrupt("return",a);case 6:case"end":return r.stop()}}),null,null,null,Promise)},this.saveSelectList=function(e,n){var a,r;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return a=e+"_"+Object(k.a)(n,"dd-MM-yyyy"),r=t.taskList.filter((function(e){return e.isSelected})).map((function(e){return{taskId:e.id,isCompleted:e.isCompleted,attachments:e.attachments.map((function(e){return{ref:e.ref,url:e.url}}))}})),o.next=4,v.a.awrap(_.collection("selectlist").doc(a).set({date:n,lastUpdate:new Date,user:e,selectedTasks:r}));case 4:return o.abrupt("return",o.sent);case 5:case"end":return o.stop()}}),null,null,null,Promise)},this.migrate=function(){return v.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:_.collection("todolist").doc("default");case 1:case"end":return e.stop()}}),null,null,null,Promise)},console.log("Initialize TaskStore..."),Object(q.f)(this)}return M()(e,[{key:"sortedTaskList",get:function(){return A()(this.taskList,["isSelected","id"],["desc","asc"])}},{key:"totalCompleted",get:function(){return this.taskList.filter((function(e){return e.isCompleted})).length}},{key:"totalSelected",get:function(){return this.taskList.filter((function(e){return e.isSelected})).length}},{key:"saveSelectTask",value:function(e){}}]),e}(),N()(o.prototype,"sortedTaskList",[q.c],Object.getOwnPropertyDescriptor(o.prototype,"sortedTaskList"),o.prototype),N()(o.prototype,"totalCompleted",[q.c],Object.getOwnPropertyDescriptor(o.prototype,"totalCompleted"),o.prototype),N()(o.prototype,"totalSelected",[q.c],Object.getOwnPropertyDescriptor(o.prototype,"totalSelected"),o.prototype),N()(o.prototype,"saveSelectTask",[q.b],Object.getOwnPropertyDescriptor(o.prototype,"saveSelectTask"),o.prototype),o),V=(c=function(){function e(){P()(this,e),K()(this,"selectedTasks",s,this)}return M()(e,[{key:"migrateData",value:function(e,t){var n,a,r,o,c,s;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=t.format(),l.next=3,v.a.awrap(_.collection("selectlist"+e).doc(n).get());case 3:return a=l.sent,l.next=6,v.a.awrap(_.collection("donelist"+e).doc(n).get());case 6:r=l.sent,o=[],c=[],s=e+"_"+n,r.exists&&r.data().doneTasks&&r.data().doneTasks.forEach((function(e){c.push(e)})),a.exists&&a.data().selectedTasks&&a.data().selectedTasks.forEach((function(n){o.push({id:s+"_"+n,taskId:n,date:t,user:e,isCompleted:c.includes(n),attachments:[]})})),_.collection("selectlist").doc(s).set({lastUpdated:new Date,selectedTasks:o});case 13:case"end":return l.stop()}}),null,null,null,Promise)}},{key:"loadSelectTasks",value:function(e,t){var n,a,r=this;return v.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=e+"_"+t,o.next=3,v.a.awrap(_.collection("selectlist").doc(n).get());case 3:(a=o.sent).exists&&a.data().selectedTasks?a.data().selectedTasks.forEach((function(e){r.selectedTasks.push(e)})):console.log("No doc values found");case 5:case"end":return o.stop()}}),null,null,null,Promise)}}]),e}(),s=N()(c.prototype,"selectedTasks",[q.h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),c),G=(new V,n(12)),X=function e(){var t=this;P()(this,e),this.loading=!1,this.addAttachments=function(e,n){var a,r,o,c,s,l,i,u;return v.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return a=t.getPlatformPath(n).value,r=t.getFileName(n.fileName,a),o="attachFiles/"+r,Object(q.i)((function(){var t={value:a,ref:o};e.attachments.push(t)})),f.next=6,v.a.awrap(fetch(a));case 6:return c=f.sent,f.next=9,v.a.awrap(c.blob());case 9:return s=f.sent,l=F.ref().child(o),f.next=13,v.a.awrap(l.put(s));case 13:return i=f.sent,f.next=16,v.a.awrap(l.getDownloadURL());case 16:return u=f.sent,e.attachments[e.attachments.length-1].url=u,f.abrupt("return",i);case 19:case"end":return f.stop()}}),null,null,null,Promise)},this.getFileName=function(e,t){if(null!=e)return e;if("ios"===G.a.OS&&(t="~"+t.substring(t.indexOf("/Documents"))),"web"==G.a.OS){var n=new Date;return Object(k.a)(n,"yyMMdd_")+Date.now()}return t.split("/").pop()},this.getPlatformPath=function(e){var t=e.path,n=e.uri;return G.a.select({android:{value:t},web:{value:n},ios:{value:n}})},this.getPlatformURI=function(e){var n=e;return isNaN(e)&&(n={uri:t.state.imagePath},"android"==G.a.OS&&(n.uri="file:///"+n.uri)),n},console.log("Initialize TaskStore..."),Object(q.f)(this)};function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Q=new function e(){P()(this,e),this.taskStore=new J(this),this.selectTaskStore=new V(this),this.storageStore=new X(this)},$=f.a.createContext(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){D()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Q)),ee=function(){return f.a.useContext($)},te=n(61),ne=n(155),ae=n(243),re=n(42),oe=O.a.create({baseText:{fontSize:11},titleText:{fontSize:15,fontWeight:"bold"}}),ce=Object(S.a)((function(e){var t,n=e.taskItem,a=Object(re.useNavigation)(),r=Object(re.useRoute)(),o=ee(),c=(o.taskStore,o.storageStore),s=Object(re.useIsFocused)();Object(u.useEffect)((function(){var e;s&&null!=(e=r.params)&&e.photo&&r.params.id==n.id&&c.addAttachments(n,r.params.photo)}),[null==(t=r.params)?void 0:t.id]);return f.a.createElement(p.ListItem,{key:n.id,style:{backgroundColor:n.isSelected?"#cde1f9":"#fcfcfc"}},f.a.createElement(p.Body,{style:{flexDirection:"row"}},f.a.createElement(T.a,null,f.a.createElement(ne.a,{onPress:function(){return e.onSelectItem(n)}},f.a.createElement(T.a,null,f.a.createElement(p.Text,{style:oe.titleText},n.id,". ",n.task),f.a.createElement(p.Text,{style:oe.baseText},"M\u1ee5c: ",n.cat," "),n.weekCount>0?f.a.createElement(p.Text,{style:{fontSize:13,color:n.weekCount>n.freqPerWeek?"red":""}},"\u0110\xe3 ch\u1ecdn: ",n.weekCount," l\u1ea7n (\u0110\u01b0\u1ee3c ch\u1ecdn ",n.freqPerWeek," l\u1ea7n) "):f.a.createElement(p.Text,{style:{fontSize:13}},"\u0110\u01b0\u1ee3c ch\u1ecdn ",n.freqPerWeek," l\u1ea7n ")))),f.a.createElement(T.a,{style:{flexDirection:"row"}},function(e){return e.attachments.map((function(e){var t;return f.a.createElement(te.a,{source:{uri:null!=(t=e.value)?t:e.url},style:{width:50,height:50,marginLeft:20}})}))}(n))),n.isSelected&&f.a.createElement(p.Right,{style:{flexDirection:"row",justifyContent:"space-around",alignContent:"center"}},f.a.createElement(p.Button,{onPress:function(){return function(e){a.navigate("CameraScreen",{sourceScreen:"HomeScreen",id:e.id})}(n)}},f.a.createElement(p.Text,null,"Ch\u1ee5p \u1ea3nh")),f.a.createElement(p.Button,{onPress:function(){return function(e){var t;return v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.a.awrap(ae.b());case 2:if(!1!==n.sent.granted){n.next=6;break}return alert("You've refused to allow this appp to access your photos!"),n.abrupt("return");case 6:return n.next=8,v.a.awrap(ae.a());case 8:(t=n.sent).cancelled?console.log("User cancelled image picker"):c.addAttachments(e,t);case 10:case"end":return n.stop()}}),null,null,null,Promise)}(n)}},f.a.createElement(p.Text,null,"G\u1eafn \u1ea3nh")),f.a.createElement(p.Switch,{value:n.isCompleted,onValueChange:function(t){e.onDoneItem(n)}})))})),se=O.a.create({result:{marginLeft:"10px",marginBottom:20,fontSize:18,fontWeight:"bold",color:"red"}}),le=Object(S.a)((function(e){var t=Object(u.useState)(new Date),n=d()(t,2),a=n[0],r=n[1],o=ee().taskStore;Object(u.useEffect)((function(){o.loadTaskList(e.user,a)}),[e.index,e.user,a]);var c=function(e){e.toggleSelect()},s=function(e){e.toggleComplete()},l=function(e){r(Object(E.a)(a,e))};return f.a.createElement(x.a,null,f.a.createElement(T.a,{style:{flexDirection:"column"}},f.a.createElement(T.a,{style:{flexDirection:"row",justifyContent:"space-around",marginTop:20,marginBottom:20}},f.a.createElement(w.a,{style:{size:""},title:"<< H\xf4m qua",onPress:function(){return l(-1)}}),f.a.createElement(w.a,{style:{size:""},title:"L\u01b0u vi\u1ec7c \u0111\xe3 ch\u1ecdn",onPress:function(){return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.awrap(o.saveSelectList(e.user,a));case 2:case"end":return t.stop()}}),null,null,null,Promise)}}),f.a.createElement(w.a,{style:{size:""},title:"H\xf4m sau >>",onPress:function(){return l(1)}}))),o.loading?f.a.createElement(p.Spinner,null):f.a.createElement(T.a,{style:{flexDirection:"column"}},f.a.createElement(p.Text,{style:se.result}," Ng\xe0y ",Object(k.a)(a,"dd-MM-yyyy"),",",e.user," \u0111\xe3 ch\u1ecdn ",o.totalSelected," vi\u1ec7c. ","\r\n"," \u0110\xe3 ho\xe0n th\xe0nh: ",o.totalCompleted," vi\u1ec7c"),f.a.createElement(p.Text,{style:{fontSize:18,fontWeight:"bold",marginLeft:15,marginBottom:20}},"Danh s\xe1ch c\xf4ng vi\u1ec7c: "),f.a.createElement(p.List,null,o.sortedTaskList.map((function(t,n){return f.a.createElement(ce,y()({key:t.id,taskItem:t,onSelectItem:c,onDoneItem:s},e))})))))})),ie=function(e){var t=Object(u.useState)(0),n=d()(t,2),a=n[0],r=n[1];return f.a.createElement(h.b,null,f.a.createElement(p.Container,null,f.a.createElement(x.a,null,f.a.createElement(p.Header,null,f.a.createElement(p.Left,null,f.a.createElement(p.Button,{transparent:!0},f.a.createElement(p.Icon,{name:"menu"}))),f.a.createElement(p.Body,null,f.a.createElement(p.Title,null,"SUMO DAYS")),f.a.createElement(p.Right,null,f.a.createElement(p.Button,{transparent:!0},f.a.createElement(p.Icon,{name:"arrow-back"})))),f.a.createElement(p.Tabs,{onChangeTab:function(e){console.log(e),r(e.i)}},f.a.createElement(p.Tab,{heading:"Susu"},f.a.createElement(le,{index:a,user:"Susu"})),f.a.createElement(p.Tab,{heading:"Nemo"},f.a.createElement(le,{index:a,user:"Nemo"})),f.a.createElement(p.Tab,{heading:"Dad"},f.a.createElement(le,{index:a,user:"Dad"}))))))},ue=function(){var e=Object(u.useState)(0),t=d()(e,2);t[0],t[1];return f.a.createElement(p.View,null,"Detail")},fe=n(62),me=n(65),de=n(605),pe=O.a.create({container:{alignSelf:"center",width:640,height:480},image:{flex:1,width:640,height:480},camera:{flex:1},buttonContainer:{flex:1,backgroundColor:"transparent",flexDirection:"row",margin:20},button:{flex:1,alignSelf:"flex-end",alignItems:"center"},text:{fontSize:18,marginLeft:20,color:"white"}}),he=function(e){var t=e.navigation,n=Object(u.useState)(null),a=d()(n,2),r=a[0],o=a[1],c=Object(u.useState)(de.a.Constants.Type.back),s=d()(c,2),l=s[0],i=s[1],m=Object(re.useRoute)(),h=Object(u.useState)(),g=d()(h,2),y=g[0],b=g[1],E=Object(u.useState)(),k=d()(E,2),S=k[0],w=k[1];if(Object(u.useEffect)((function(){!function(){var e,t;v.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.a.awrap(de.a.requestPermissionsAsync());case 2:e=n.sent,t=e.status,o("granted"===t);case 5:case"end":return n.stop()}}),null,null,null,Promise)}()}),[]),null===r)return f.a.createElement(T.a,null);if(!1===r)return f.a.createElement(fe.a,null,"No access to camera");var x=function(){var e;t.navigate(m.params.sourceScreen,{photo:y,sourceScreen:"CameraScreen",id:null==(e=m.params)?void 0:e.id})};return f.a.createElement(T.a,{style:pe.container},!y&&f.a.createElement(de.a,{style:pe.camera,type:l,ref:function(e){w(e)}},f.a.createElement(T.a,{style:pe.buttonContainer},f.a.createElement(me.a,{style:pe.button,onPress:function(){i(l===de.a.Constants.Type.back?de.a.Constants.Type.front:de.a.Constants.Type.back)}},f.a.createElement(T.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-around",alignContent:"center",marginLeft:20}},f.a.createElement(fe.a,{style:pe.text}," Camera sau "),f.a.createElement(fe.a,{style:pe.text,onPress:function(){var e;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!S){t.next=5;break}return t.next=3,v.a.awrap(S.takePictureAsync());case 3:e=t.sent,b(e);case 5:case"end":return t.stop()}}),null,null,null,Promise)}}," Ch\u1ee5p \u1ea3nh "),f.a.createElement(p.Button,{transparent:!0,style:{marginRight:20},onPress:x},f.a.createElement(p.Icon,{name:"arrow-back"})))))),y&&f.a.createElement(T.a,{style:{flex:1,flexDirection:"column",justifyContent:"space-around",alignContent:"center",marginLeft:20}},f.a.createElement(te.a,{source:{uri:y.uri},style:pe.image}),f.a.createElement(T.a,{style:{flexDirection:"row",justifyContent:"space-around",alignContent:"center"}},f.a.createElement(p.Button,{onPress:function(){b(null)}},f.a.createElement(fe.a,{style:{fontSize:18}}," Ch\u1ee5p l\u1ea1i ")),f.a.createElement(p.Button,{onPress:x},f.a.createElement(fe.a,{style:{fontSize:18}}," T\u1ea3i \u1ea3nh ")))))},ge=Object(i.a)(),ye=function(e){e.navigation;return f.a.createElement(ge.Navigator,{headerMode:"none"},f.a.createElement(ge.Screen,{name:"HomeScreen",component:ie}),f.a.createElement(ge.Screen,{name:"CameraScreen",component:he}),f.a.createElement(ge.Screen,{name:"TaskDetailScreen",component:ue}))},be=function(e){var t=e.navigation;return f.a.createElement(View,{style:{flex:1,alignItems:"center",justifyContent:"center"}},f.a.createElement(Text,{style:{fontSize:30}},"This is a modal!"),f.a.createElement(Button,{onPress:function(){return t.goBack()},title:"Dismiss"}))},ve=Object(i.a)(),Ee=function(e){e.navigation;return f.a.createElement(ve.Navigator,{headerMode:"none"},f.a.createElement(ve.Screen,{name:"LoginScreen",component:be}),f.a.createElement(ve.Screen,{name:"Details",component:ue}))},ke=Object(i.a)();t.a=function(){return f.a.createElement(l.a,null,f.a.createElement(ke.Navigator,{mode:"modal",headerMode:"none"},f.a.createElement(ke.Screen,{name:"Main",component:ye}),f.a.createElement(ke.Screen,{name:"MyModal",component:Ee})))}},388:function(e,t,n){e.exports=n(588)}},[[388,1,2]]]);
//# sourceMappingURL=app.1da6b31e.chunk.js.map